<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form id="updateForm">
<div style="padding: 50px; line-height: 22px; background-color: #393D49; color: #fff; font-weight: 300;">

    <div class="layui-form-item">
        <label class="layui-form-label">车辆编号：</label>
        <div class="layui-input-block">
            <input type="hidden" name="id" id="carid"  th:value="${car.id}">
            <b th:text="${car.id}"></b>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">车牌号</label>
        <div class="layui-input-block">
            <input type="text" name="carNumber" th:value="${car.carNumber}" lay-verify="title" autocomplete="off" placeholder="请输入车牌号" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">汽车品牌</label>
        <div class="layui-input-block">
            <input type="text" name="carXing" th:value="${car.carXing}" lay-verify="title" autocomplete="off" placeholder="请输入汽车品牌" class="layui-input">
        </div>
    </div>
    <div class="layui-input-inline">
        <label class="layui-form-label">档位</label>
        <select name="carDangType" >
            <option value="" th:selected="${car.carDangType==0}">请选择</option>
            <option value="自动挡" th:selected="${car.carDangType=='自动挡'}">自动档</option>
            <option value="手动挡" th:selected="${car.carDangType=='手动挡'}">手动档</option>
        </select>
    </div>
    <div class="layui-input-inline">
            <label class="layui-form-label">座位数</label>
            <select name="carZuoWei" >
                <option value="" th:selected="${car.carZuoWei==0}">请选择</option>
                <option value="5" th:selected="${car.carZuoWei==5}">5</option>
                <option value="7" th:selected="${car.carZuoWei==7}">7</option>
            </select>
     </div>
    <div class="layui-input-inline">
            <label class="layui-form-label">车排量</label>
            <select name="carpailiang" >
                <option value="" th:selected="${car.carpailiang=='0'}">请选择</option>
                <option value="1.0" th:selected="${car.carpailiang=='1.0'}">1.0</option>
                <option value="1.2" th:selected="${car.carpailiang=='1.2'}">1.2</option>
                <option value="1.6" th:selected="${car.carpailiang=='1.6'}">1.6</option>
                <option value="1.8" th:selected="${car.carpailiang=='1.8'}">1.8</option>
                <option value="2.0" th:selected="${car.carpailiang=='2.0'}">2.0</option>
                <option value="2.4" th:selected="${car.carpailiang=='2.4'}">2.4</option>
                <option value="3.0" th:selected="${car.carpailiang=='3.0'}">3.0</option>
            </select>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">汽车图片</label>
        <input type="hidden" name="carlogo" id="carimgId">
        <div class="layui-input-block">
            <div class="layui-upload">
                <button type="button" class="layui-btn" id="test1">上传图片</button>
                <div class="layui-upload-list">
                    <input type="hidden" name="carlogo" id="carlogoHid2" th:value="${car.carlogo}">
                    <img width="100px" height="70px" class="layui-upload-img" id="demo1">
                    <p id="demoText"></p>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">租赁价格</label>
        <div class="layui-input-block">
            <input type="text" name="carPrice" th:value="${car.carPrice}" lay-verify="title" autocomplete="off" placeholder="租赁价格" class="layui-input">
        </div>
    </div>
    <div class="layui-input-inline">
        <label class="layui-form-label">所在门店</label>
        <input id="selectId" th:value="${car.carMenDianId}" type="hidden">
        <select name="carMenDianId" id="selectCarMenDianId"></select>

    </div>
</div>
</form>
</body>
<script type="text/javascript">
    $(function(){
        findmendian()
        var logo=$("#carlogoHid").val();
        $("#demo1").prop("src",logo);
    });
    //门店回显
    function findmendian(){
        var carMenDianId = $("#selectId").val();
        $.ajax({
            url : "../client/findmendian",
            type : "post",
            dataType : "json",
            success : function (data){
                console.log(data);
                var str = "<option value='0'>请选择</option>";
                for(var i=0; i<data.length;i++){
                    str += "<option value='"+data[i].id+"'>"+data[i].menDianName+"</option>";

                }
                $("#selectCarMenDianId").html(str);
                $("#selectCarMenDianId").val(carMenDianId);
            },error : function (){
                alert("门店失败");
            }
        });
    }






    //上传图片
    layui.use('upload', function() {
        var $ = layui.jquery
            , upload = layui.upload;
        //普通图片上传
        var uploadInst = upload.render({
            elem: '#test1'
            , url: '/client/upload'
            , before: function (obj) {
                //预读本地文件示例，不支持ie8
                obj.preview(function (index, file, result) {
                    $('#demo1').attr('src', result); //图片链接（base64）
                });
            }
            ,done: function (res) {
                //如果上传失败
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $("#carlogoHid2").val(res.data.src);
                //上传成功
            }
            , error: function () {
                //演示失败状态，并实现重传
                var demoText = $('#demoText');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function () {
                    uploadInst.upload();
                });
            }
        });
    })
</script>
</html>